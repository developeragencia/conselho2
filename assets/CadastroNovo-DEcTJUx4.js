import{r as n,j as e,L as y,C as v,a as w,b as C,c as b,d as N,e as h,ad as V,B as H,I as p}from"./index-DOubVUE4.js";import{L as c}from"./label-CNvRtqVC.js";import{A as k,a as F}from"./alert-B7H8KRQb.js";import{C as t}from"./check-BayUS100.js";import{U as I}from"./user-Bgp2XcVx.js";import{C as J}from"./crown-DcTeZNLG.js";import{S as E}from"./search-CYf94K1M.js";function X(){const[o,g]=n.useState(1),[i,S]=n.useState("cliente"),[d,R]=n.useState(""),[x,A]=n.useState(null),[u,j]=n.useState(!1),[f,l]=n.useState(""),[r,m]=n.useState({email:"",password:"",confirmPassword:"",phone:"",specialties:[],description:"",hourlyRate:""}),P=s=>s.replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"),T=async()=>{if(d.replace(/\D/g,"").length!==11){l("CPF deve ter 11 dígitos");return}j(!0),l("");try{console.log("🔍 Buscando dados do CPF:",d);const s=await fetch("/api/cpf/consulta",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cpf:d.replace(/\D/g,"")})});if(!s.ok)throw new Error("Erro ao consultar CPF");const a=await s.json();a.success?(A(a.data),g(3)):l(a.message||"CPF não encontrado ou inválido")}catch(s){console.error("Erro na consulta:",s),l("Erro ao consultar dados. Tente novamente.")}finally{j(!1)}},z=async()=>{if(r.password!==r.confirmPassword){l("Senhas não coincidem");return}if(!r.email||!r.password||!r.phone){l("Preencha todos os campos obrigatórios");return}j(!0),l("");try{const s={name:(x==null?void 0:x.nome)||"Nome não encontrado",email:r.email,password:r.password,role:i,cpf:d.replace(/\D/g,""),phone:r.phone,...i==="consultor"&&{specialties:r.specialties,description:r.description,hourlyRate:parseFloat(r.hourlyRate)||0}};console.log("🚀 CADASTRO ENVIANDO PARA:","/api/auth/register");const a=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),D=await a.json();if(a.ok&&D.success)g(4);else throw new Error(D.message||"Erro no cadastro")}catch(s){console.error("Erro no cadastro:",s),l(s.message||"Erro ao finalizar cadastro")}finally{j(!1)}},$=()=>e.jsxs(v,{className:"w-full max-w-2xl mx-auto",children:[e.jsxs(w,{className:"text-center",children:[e.jsx(C,{className:"text-2xl font-bold text-purple-800 dark:text-purple-300",children:"Escolha o Tipo de Conta"}),e.jsx(b,{children:"Selecione como você deseja usar nossa plataforma"})]}),e.jsxs(N,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:`border-2 rounded-lg p-6 cursor-pointer transition-all hover:shadow-lg ${i==="cliente"?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-orange-300"}`,onClick:()=>S("cliente"),children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx(I,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-orange-600 dark:text-orange-400",children:"Cliente"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Acesso a consultas e serviços esotéricos"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Consultas por chat e vídeo"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Créditos de bônus"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Histórico de consultas"})]})]})]})}),e.jsx("div",{className:`border-2 rounded-lg p-6 cursor-pointer transition-all hover:shadow-lg ${i==="consultor"?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-purple-300"}`,onClick:()=>S("consultor"),children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(J,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-purple-600 dark:text-purple-400",children:"Consultor"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Ofereça seus serviços esotéricos na plataforma"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Perfil profissional"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Defina seus horários"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Receba pagamentos"})]})]})]})})]}),e.jsxs(h,{onClick:()=>g(2),className:"w-full bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600",size:"lg",children:["Continuar",e.jsx(V,{className:"w-4 h-4 ml-2"})]})]})]}),L=()=>e.jsxs(v,{className:"w-full max-w-md mx-auto",children:[e.jsxs(w,{className:"text-center",children:[e.jsx(C,{className:"text-2xl font-bold text-purple-800 dark:text-purple-300",children:"Consulta CPF"}),e.jsx(b,{children:"Digite seu CPF para buscar seus dados automaticamente"}),e.jsx(H,{variant:"outline",className:"mx-auto",children:i==="cliente"?"Cliente":"Consultor"})]}),e.jsxs(N,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"cpf",children:"CPF"}),e.jsx(p,{id:"cpf",type:"text",placeholder:"000.000.000-00",value:d,onChange:s=>R(P(s.target.value)),maxLength:14,className:"text-center text-lg"})]}),f&&e.jsx(k,{variant:"destructive",children:e.jsx(F,{children:f})}),e.jsx(h,{onClick:T,disabled:u||d.replace(/\D/g,"").length!==11,className:"w-full bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600",size:"lg",children:u?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2 animate-spin"}),"Consultando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Buscar Dados"]})}),e.jsx("div",{className:"text-center",children:e.jsx(h,{variant:"ghost",onClick:()=>g(1),children:"Voltar"})})]})]}),O=()=>e.jsxs(v,{className:"w-full max-w-2xl mx-auto",children:[e.jsxs(w,{className:"text-center",children:[e.jsx(C,{className:"text-2xl font-bold text-purple-800 dark:text-purple-300",children:"Finalizar Cadastro"}),e.jsx(b,{children:"Complete seus dados para finalizar"})]}),e.jsxs(N,{className:"space-y-6",children:[x&&e.jsxs(k,{children:[e.jsx(t,{className:"w-4 h-4"}),e.jsxs(F,{children:[e.jsx("strong",{children:"Dados encontrados:"})," ",x.nome,e.jsx("br",{}),e.jsx("strong",{children:"CPF:"})," ",P(x.cpf)]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"email",children:"Email *"}),e.jsx(p,{id:"email",type:"email",value:r.email,onChange:s=>m(a=>({...a,email:s.target.value})),placeholder:"seu@email.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"phone",children:"Telefone *"}),e.jsx(p,{id:"phone",type:"tel",value:r.phone,onChange:s=>m(a=>({...a,phone:s.target.value})),placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"password",children:"Senha *"}),e.jsx(p,{id:"password",type:"password",value:r.password,onChange:s=>m(a=>({...a,password:s.target.value})),placeholder:"Mínimo 6 caracteres"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"confirmPassword",children:"Confirmar Senha *"}),e.jsx(p,{id:"confirmPassword",type:"password",value:r.confirmPassword,onChange:s=>m(a=>({...a,confirmPassword:s.target.value})),placeholder:"Repita a senha"})]})]}),i==="consultor"&&e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-700 dark:text-purple-300",children:"Dados Profissionais"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"description",children:"Descrição Profissional"}),e.jsx("textarea",{id:"description",className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",rows:3,value:r.description,onChange:s=>m(a=>({...a,description:s.target.value})),placeholder:"Descreva sua experiência e especialidades..."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"hourlyRate",children:"Valor por Hora (R$)"}),e.jsx(p,{id:"hourlyRate",type:"number",min:"0",step:"0.01",value:r.hourlyRate,onChange:s=>m(a=>({...a,hourlyRate:s.target.value})),placeholder:"50.00"})]})})]}),f&&e.jsx(k,{variant:"destructive",children:e.jsx(F,{children:f})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(h,{variant:"outline",onClick:()=>g(2),className:"flex-1",children:"Voltar"}),e.jsx(h,{onClick:z,disabled:u,className:"flex-1 bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600",children:u?"Cadastrando...":"Finalizar Cadastro"})]})]})]}),B=()=>e.jsx(v,{className:"w-full max-w-md mx-auto",children:e.jsxs(N,{className:"pt-6 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(t,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:"Cadastro Realizado!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Sua conta foi criada com sucesso"})]}),e.jsx(y,{href:"/login",children:e.jsx(h,{className:"w-full bg-gradient-to-r from-purple-600 to-orange-500 hover:from-purple-700 hover:to-orange-600",children:"Fazer Login"})})]})});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-orange-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 py-8 px-4",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(y,{href:"/",children:e.jsx("img",{src:"/logo.png",alt:"Conselhos Esotéricos",className:"h-16 mx-auto mb-4"})}),e.jsx("h1",{className:"text-3xl font-bold text-purple-800 dark:text-purple-300",children:"Criar Nova Conta"}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("div",{className:"flex items-center space-x-4",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${s<=o?"bg-purple-600 text-white":"bg-gray-200 text-gray-600"}`,children:s<o?e.jsx(t,{className:"w-4 h-4"}):s}),s<4&&e.jsx("div",{className:`w-12 h-1 mx-2 ${s<o?"bg-purple-600":"bg-gray-200"}`})]},s))})})]}),o===1&&$(),o===2&&L(),o===3&&O(),o===4&&B(),e.jsx("div",{className:"text-center mt-8",children:e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Já tem uma conta?"," ",e.jsx(y,{href:"/login",className:"text-purple-600 hover:underline",children:"Fazer Login"})]})})]})})}export{X as default};
